import{c as le,a as r,j as e}from"./createLucideIcon-CQGyNZ_Q.js";import{C as h,a as p}from"./card-Dn37DIUt.js";import{u as ie,B as v,k as Z,e as z,d as f,q as de,c as B,w as ce,a as me,f as xe,b as he}from"./button-Dt3GSqWm.js";import{u as pe,v as ue}from"./uploadPhotoToStorage-IzdR3ISv.js";import{S as J}from"./sparkles-C6UHyn36.js";import{C as K}from"./calendar-CVpTigiW.js";import{T as N,H as je,S as ge}from"./target-PIB22ZZm.js";import{C as q}from"./circle-check-D78cfl_i.js";import{C as _}from"./clock-Bae6WcDb.js";import{C as w}from"./camera-ByWCIk_p.js";import{X as fe}from"./x-BMGkUyBb.js";import{U as be}from"./upload-Cc5y0_BP.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],ve=le("gift",ye);function Ne(){const[o,t]=r.useState("");return r.useEffect(()=>{const m=()=>{const u=new Date,n=new Date;n.setDate(n.getDate()+1),n.setHours(0,0,0,0);const c=n-u;if(c>0){const b=Math.floor(c/36e5),k=Math.floor(c%(1e3*60*60)/(1e3*60)),D=Math.floor(c%(1e3*60)/1e3);t(`${b.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}:${D.toString().padStart(2,"0")}`)}else t("00:00:00")};m();const d=setInterval(m,1e3);return()=>clearInterval(d)},[]),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-mono font-bold text-gray-900 mb-2",children:o}),e.jsx("p",{className:"text-sm text-gray-600",children:"do dalšího dne"})]})}function Ie(){const{user:o}=ie(),[t,m]=r.useState(1),[d,u]=r.useState(null),[n,c]=r.useState({}),[b,k]=r.useState(null),[D,G]=r.useState(!0),[T,R]=r.useState(!1),[l,j]=r.useState({mood:0,skinRating:0,note:"",completed:!1,photos:[]}),[C,M]=r.useState(null),[S,L]=r.useState(null),[U,E]=r.useState(!1),F=r.useRef(null);r.useEffect(()=>{window.scrollTo(0,0),(async()=>{if(o)try{const x=(await Z(z(f,"users",o.uid))).data(),y=x?.currentDay||1;m(y),k(x);const $=await Z(z(f,"dailyContent",`day-${y}`)),re=$.exists()?$.data():null;u(re);const oe=de(B(f,"userLogs"),ce("userId","==",o.uid)),H=await me(oe),O={};H.forEach(P=>{const i=P.data();O[i.day]=i}),c(O);const ne=new Date().toDateString();let V=!1;H.forEach(P=>{const i=P.data();(i.createdAt?.toDate?.()||new Date(i.createdAt)).toDateString()===ne&&(V=!0,j({mood:i.mood||0,skinRating:i.skinRating||0,note:i.note||"",completed:!0,photos:i.photos||[]}))}),R(V)}catch(a){console.error("Chyba při načítání dat:",a)}finally{G(!1)}})()},[o]);const Q=s=>{j(a=>({...a,mood:s}))},X=s=>{j(a=>({...a,skinRating:s}))},W=s=>{const a=s.target.files[0];if(a)try{ue(a),M(a);const x=new FileReader;x.onload=y=>{L(y.target.result)},x.readAsDataURL(a)}catch(x){alert(x.message)}},Y=async()=>{if(!C){alert("Nejdřív vyber fotografii");return}E(!0);try{const s=await pe(C,o.uid,t,"progress");j(a=>({...a,photos:[{url:s,type:"progress"}]})),alert("Fotka byla úspěšně nahrána! 📸 Teď můžeš dokončit den.")}catch(s){console.error("Chyba při nahrávání fotky:",s),alert("Chyba při nahrávání fotky: "+s.message)}finally{E(!1)}},ee=async()=>{if(!l.mood||!l.skinRating){alert("Prosím, vyplň náladu a hodnocení pleti před dokončením dne.");return}if(g&&(!l.photos||l.photos.length===0)){alert("Dnes je foto den! Prosím nahraj fotografii svého obličeje pro sledování pokroku.");return}try{await xe(B(f,"userLogs"),{userId:o.uid,day:t,mood:l.mood,skinRating:l.skinRating,note:l.note,createdAt:new Date,photos:l.photos||[]}),await he(z(f,"users",o.uid),{currentDay:t+1,completedDays:[...b?.completedDays||[],t],updatedAt:new Date}),R(!0),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)}catch(s){console.error("Chyba při ukládání:",s),alert("Chyba při ukládání dat")}};if(D)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-pink-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Načítání tvého dne..."})]})});const g=d?.isPhotoDay||!1,se=Object.keys(n).length,A=we(n,t),te=[{value:1,emoji:"😞",label:"Špatná"},{value:2,emoji:"😕",label:"Horší"},{value:3,emoji:"😐",label:"Neutrální"},{value:4,emoji:"😊",label:"Dobrá"},{value:5,emoji:"😄",label:"Výborná"}],I=["Zítra tě čeká nový den plný možností! 🌟","Odpočiň si a připrav se na další krok k dokonalé pleti! ✨","Tvoje pleť se bude zítra těšit na další péči! 💖","Každý nový den je šancí být ještě krásnější! 🌸","Zítřejší den přinese nové tipy pro tvou pleť! 🎯"],ae=I[Math.floor(Math.random()*I.length)];return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("header",{className:"bg-gradient-to-r from-pink-500 to-rose-500 text-white sticky top-0 z-10 shadow-lg",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center backdrop-blur-sm",children:e.jsx(J,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Ahoj, ",b?.name||"Tereza","! 👋"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("p",{className:"text-pink-100 flex items-center space-x-1",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsxs("span",{children:["Den ",t]})]}),e.jsxs("p",{className:"text-pink-100 flex items-center space-x-1",children:[e.jsx(N,{className:"w-4 h-4"}),e.jsxs("span",{children:[A," dní v řadě 🔥"]})]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-5xl font-bold text-white",children:t}),e.jsx("div",{className:"text-pink-200",children:"z 365 dní"})]})]})})})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[T&&e.jsx(h,{className:"border border-green-200 bg-gradient-to-r from-green-50 to-emerald-50 shadow-lg",children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto",children:e.jsx(q,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:["Skvělá práce! Den ",t," dokončen! 🎉"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Už jsi dnes vyplnila svůj denní záznam. Počkej si na další den!"})]}),e.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Další den za:"})]}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 rounded-xl p-4 border border-pink-200",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[e.jsx(ve,{className:"w-5 h-5 text-pink-500"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Na co se můžeš těšit"})]}),e.jsx("p",{className:"text-sm text-gray-700 text-center",children:ae})]})]})})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(h,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs(p,{className:"p-3 text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-1",children:e.jsx(q,{className:"w-4 h-4 text-green-600"})}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:se}),e.jsx("p",{className:"text-xs text-gray-600",children:"Splněno"})]})}),e.jsx(h,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs(p,{className:"p-3 text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center mx-auto mb-1",children:e.jsx(N,{className:"w-4 h-4 text-orange-600"})}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:A}),e.jsx("p",{className:"text-xs text-gray-600",children:"V řadě"})]})}),e.jsx(h,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs(p,{className:"p-3 text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-1",children:e.jsx(K,{className:"w-4 h-4 text-blue-600"})}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:365-t}),e.jsx("p",{className:"text-xs text-gray-600",children:"Zbývá"})]})})]}),e.jsx(h,{className:"border border-gray-200 shadow-sm",children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-pink-500 to-rose-500 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(J,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Denní motivace"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:d?.motivation||`Už ${t} dní děláš skvělou práci! Tvoje pleť se postupně zlepšuje a ty si to zasloužíš! 💖`})]})]})})}),e.jsx(h,{className:"border border-gray-200 shadow-sm",children:e.jsxs(p,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-xl flex items-center justify-center",children:e.jsx(N,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Dnešní úkol"}),g&&e.jsxs("p",{className:"text-sm text-orange-600 flex items-center space-x-1",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsxs("span",{children:["Foto den - týden ",Math.ceil(t/7)]})]})]})]}),e.jsx("div",{className:"prose max-w-none",children:e.jsx("pre",{className:"whitespace-pre-wrap font-sans text-gray-700 leading-relaxed text-sm",children:d?.task||`🎯 DEN ${t} - DŮVĚŘUJ PROCESU!

📌 VZPOMEŇ SI:
Kdy jsi naposledy dostala kompliment na svou pleť?

💪 ÚKOL:
Dnes se podívej do zrcadla a najdi 3 věci, které se ti na své pleti líbí.
⭐ Napiš si je do poznámky a usmej se na sebe!`})})]})}),!T&&e.jsx(h,{className:"border border-gray-200 shadow-sm",children:e.jsxs(p,{className:"p-6 space-y-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[e.jsx(je,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{children:"Jak se dnes cítíš?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Celková nálada"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:te.map(s=>e.jsxs("button",{onClick:()=>Q(s.value),className:`
                        p-3 rounded-lg border-2 transition-all duration-200 text-center
                        ${l.mood===s.value?"border-pink-500 bg-pink-50 shadow-md transform scale-105":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}
                      `,children:[e.jsx("div",{className:"text-2xl mb-1",children:s.emoji}),e.jsx("div",{className:"text-xs text-gray-600",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Hodnocení pleti (1-5 hvězdiček)"}),e.jsx("div",{className:"flex space-x-2 justify-center",children:[1,2,3,4,5].map(s=>e.jsx("button",{onClick:()=>X(s),className:"p-2 rounded-lg transition-colors duration-200 hover:bg-gray-100",children:e.jsx(ge,{className:`w-8 h-8 ${s<=l.skinRating?"text-yellow-400 fill-current":"text-gray-300"}`})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Poznámka (volitelné)"}),e.jsx("textarea",{value:l.note,onChange:s=>j(a=>({...a,note:s.target.value})),placeholder:"Jak se dnes cítíš? Nějaké změny na pleti?",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent resize-none",rows:3})]}),g&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-start space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(w,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-1",children:["Povinná fotodokumentace - Den ",t]}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"Dnes je čas na týdenní fotografii pokroku! Pořiď si selfie svého obličeje, abychom ti mohli ukázat, jak se tvá pleť zlepšuje. 📸"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("p",{children:["💡 ",e.jsx("strong",{children:"Tip:"})," Foť se vždy za stejného světla a ze stejného úhlu"]}),e.jsxs("p",{children:["🔒 ",e.jsx("strong",{children:"Soukromí:"})," Tvoje fotky jsou pouze tvoje - nikdo jiný je neuvidí"]}),e.jsxs("p",{children:["🛡️ ",e.jsx("strong",{children:"Bezpečnost:"})," Fotky jsou šifrovaně uložené a není možné je zveřejnit"]})]})]})]}),S&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:S,alt:"Preview pokroku",className:"max-w-full max-h-48 rounded-lg shadow-md border-2 border-white"}),e.jsx("button",{onClick:()=>{M(null),L(null),j(s=>({...s,photos:[]}))},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 shadow-lg",children:e.jsx(fe,{className:"w-4 h-4"})}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"✓ Připraveno k uložení"})]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(v,{onClick:()=>F.current?.click(),variant:"outline",className:"flex-1 border-blue-300 text-blue-700 hover:bg-blue-50",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),S?"Změnit foto":"Vybrat foto"]}),C&&!U&&e.jsxs(v,{onClick:Y,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Nahrát foto"]}),U&&e.jsxs(v,{disabled:!0,className:"flex-1 bg-gray-400 text-white cursor-not-allowed",children:[e.jsx(_,{className:"w-4 h-4 mr-2 animate-spin"}),"Nahrávám..."]})]}),e.jsx("input",{ref:F,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:W,className:"hidden"})]})}),e.jsx(v,{onClick:ee,className:"w-full py-3 text-lg font-semibold rounded-lg bg-gradient-to-r from-pink-500 to-rose-500 text-white hover:from-pink-600 hover:to-rose-600 transform hover:scale-105 transition-all duration-200",children:e.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[e.jsx(N,{className:"w-5 h-5"}),e.jsx("span",{children:g?"Dokončit den + foto":"Dokončit den"})]})}),g&&e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-orange-600 flex items-center justify-center space-x-1",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:"Foto je dnes povinné pro dokončení dne"})]})})]})})]})]})}function we(o,t){const m=Object.keys(o).map(Number).sort((n,c)=>c-n);if(m.length===0)return 0;let d=0,u=t-1;for(const n of m)if(n===u)d++,u--;else break;return d}export{Ie as default};
