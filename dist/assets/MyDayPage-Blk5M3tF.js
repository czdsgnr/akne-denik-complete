import{c as de,j as e}from"./createLucideIcon-BVK-TNov.js";import{r as o}from"./router-CzIOuVrz.js";import{C as p,a as j}from"./card-Dxmm2ME_.js";import{u as ce,B as N,d as b}from"./button-B9rjGe4R.js";import{h as J,d as T,q as me,c as K,w as xe,a as he,b as pe,u as je}from"./firebase-DxUWQnlV.js";import{u as ue,v as ge}from"./uploadPhotoToStorage-IzdR3ISv.js";import{S as q}from"./sparkles-7mg9HYtw.js";import{C as _}from"./calendar-CfB4sLkh.js";import{T as w,H as fe,S as be}from"./target-DLi08z85.js";import{C as G}from"./circle-check-r0udbRd9.js";import{C as Q}from"./clock-DTOIgMDV.js";import{C as k}from"./camera-CV06bDGE.js";import{X as ve}from"./x-DTG6k3nd.js";import{U as ye}from"./upload-CqvkSwM5.js";import"./vendor-Csw2ODfV.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],we=de("gift",Ne);function ke(){const[n,t]=o.useState("");return o.useEffect(()=>{const h=()=>{const u=new Date,l=new Date;l.setDate(l.getDate()+1),l.setHours(0,0,0,0);const m=l-u;if(m>0){const x=Math.floor(m/36e5),D=Math.floor(m%(1e3*60*60)/(1e3*60)),S=Math.floor(m%(1e3*60)/1e3);t(`${x.toString().padStart(2,"0")}:${D.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}`)}else t("00:00:00")};h();const r=setInterval(h,1e3);return()=>clearInterval(r)},[]),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-mono font-bold text-gray-900 mb-2",children:n}),e.jsx("p",{className:"text-sm text-gray-600",children:"do dalšího dne"})]})}function Ze(){const{user:n}=ce(),[t,h]=o.useState(1),[r,u]=o.useState(null),[l,m]=o.useState({}),[x,D]=o.useState(null),[S,X]=o.useState(!0),[R,M]=o.useState(!1),[i,g]=o.useState({mood:0,skinRating:0,note:"",completed:!1,photos:[]}),[C,L]=o.useState(null),[P,U]=o.useState(null),[E,F]=o.useState(!1),A=o.useRef(null);o.useEffect(()=>{window.scrollTo(0,0),(async()=>{if(n)try{const d=(await J(T(b,"users",n.uid))).data(),v=(d==null?void 0:d.currentDay)||1;h(v),D(d);const I=await J(T(b,"dailyContent",`day-${v}`)),ne=I.exists()?I.data():null;u(ne);const le=me(K(b,"userLogs"),xe("userId","==",n.uid)),O=await he(le),V={};O.forEach(z=>{const c=z.data();V[c.day]=c}),m(V);const ie=new Date().toDateString();let Z=!1;O.forEach(z=>{var y,B;const c=z.data();(((B=(y=c.createdAt)==null?void 0:y.toDate)==null?void 0:B.call(y))||new Date(c.createdAt)).toDateString()===ie&&(Z=!0,g({mood:c.mood||0,skinRating:c.skinRating||0,note:c.note||"",completed:!0,photos:c.photos||[]}))}),M(Z)}catch(a){console.error("Chyba při načítání dat:",a)}finally{X(!1)}})()},[n]);const W=s=>{g(a=>({...a,mood:s}))},Y=s=>{g(a=>({...a,skinRating:s}))},ee=s=>{const a=s.target.files[0];if(a)try{ge(a),L(a);const d=new FileReader;d.onload=v=>{U(v.target.result)},d.readAsDataURL(a)}catch(d){alert(d.message)}},se=async()=>{if(!C){alert("Nejdřív vyber fotografii");return}F(!0);try{const s=await ue(C,n.uid,t,"progress");g(a=>({...a,photos:[{url:s,type:"progress"}]})),alert("Fotka byla úspěšně nahrána! 📸 Teď můžeš dokončit den.")}catch(s){console.error("Chyba při nahrávání fotky:",s),alert("Chyba při nahrávání fotky: "+s.message)}finally{F(!1)}},te=async()=>{if(!i.mood||!i.skinRating){alert("Prosím, vyplň náladu a hodnocení pleti před dokončením dne.");return}if(f&&(!i.photos||i.photos.length===0)){alert("Dnes je foto den! Prosím nahraj fotografii svého obličeje pro sledování pokroku.");return}try{await pe(K(b,"userLogs"),{userId:n.uid,day:t,mood:i.mood,skinRating:i.skinRating,note:i.note,createdAt:new Date,photos:i.photos||[]}),await je(T(b,"users",n.uid),{currentDay:t+1,completedDays:[...(x==null?void 0:x.completedDays)||[],t],updatedAt:new Date}),M(!0),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)}catch(s){console.error("Chyba při ukládání:",s),alert("Chyba při ukládání dat")}};if(S)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-pink-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Načítání tvého dne..."})]})});const f=(r==null?void 0:r.isPhotoDay)||!1,ae=Object.keys(l).length,$=De(l,t),re=[{value:1,emoji:"😞",label:"Špatná"},{value:2,emoji:"😕",label:"Horší"},{value:3,emoji:"😐",label:"Neutrální"},{value:4,emoji:"😊",label:"Dobrá"},{value:5,emoji:"😄",label:"Výborná"}],H=["Zítra tě čeká nový den plný možností! 🌟","Odpočiň si a připrav se na další krok k dokonalé pleti! ✨","Tvoje pleť se bude zítra těšit na další péči! 💖","Každý nový den je šancí být ještě krásnější! 🌸","Zítřejší den přinese nové tipy pro tvou pleť! 🎯"],oe=H[Math.floor(Math.random()*H.length)];return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("header",{className:"bg-gradient-to-r from-pink-500 to-rose-500 text-white sticky top-0 z-10 shadow-lg",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center backdrop-blur-sm",children:e.jsx(q,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Ahoj, ",(x==null?void 0:x.name)||"Tereza","! 👋"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("p",{className:"text-pink-100 flex items-center space-x-1",children:[e.jsx(_,{className:"w-4 h-4"}),e.jsxs("span",{children:["Den ",t]})]}),e.jsxs("p",{className:"text-pink-100 flex items-center space-x-1",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsxs("span",{children:[$," dní v řadě 🔥"]})]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-5xl font-bold text-white",children:t}),e.jsx("div",{className:"text-pink-200",children:"z 365 dní"})]})]})})})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[R&&e.jsx(p,{className:"border border-green-200 bg-gradient-to-r from-green-50 to-emerald-50 shadow-lg",children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto",children:e.jsx(G,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:["Skvělá práce! Den ",t," dokončen! 🎉"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Už jsi dnes vyplnila svůj denní záznam. Počkej si na další den!"})]}),e.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Další den za:"})]}),e.jsx(ke,{})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 rounded-xl p-4 border border-pink-200",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[e.jsx(we,{className:"w-5 h-5 text-pink-500"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Na co se můžeš těšit"})]}),e.jsx("p",{className:"text-sm text-gray-700 text-center",children:oe})]})]})})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(p,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs(j,{className:"p-3 text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-1",children:e.jsx(G,{className:"w-4 h-4 text-green-600"})}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:ae}),e.jsx("p",{className:"text-xs text-gray-600",children:"Splněno"})]})}),e.jsx(p,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs(j,{className:"p-3 text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center mx-auto mb-1",children:e.jsx(w,{className:"w-4 h-4 text-orange-600"})}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:$}),e.jsx("p",{className:"text-xs text-gray-600",children:"V řadě"})]})}),e.jsx(p,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs(j,{className:"p-3 text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-1",children:e.jsx(_,{className:"w-4 h-4 text-blue-600"})}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:365-t}),e.jsx("p",{className:"text-xs text-gray-600",children:"Zbývá"})]})})]}),e.jsx(p,{className:"border border-gray-200 shadow-sm",children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-pink-500 to-rose-500 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(q,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Denní motivace"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:(r==null?void 0:r.motivation)||`Už ${t} dní děláš skvělou práci! Tvoje pleť se postupně zlepšuje a ty si to zasloužíš! 💖`})]})]})})}),e.jsx(p,{className:"border border-gray-200 shadow-sm",children:e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-xl flex items-center justify-center",children:e.jsx(w,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Dnešní úkol"}),f&&e.jsxs("p",{className:"text-sm text-orange-600 flex items-center space-x-1",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsxs("span",{children:["Foto den - týden ",Math.ceil(t/7)]})]})]})]}),e.jsx("div",{className:"prose max-w-none",children:e.jsx("pre",{className:"whitespace-pre-wrap font-sans text-gray-700 leading-relaxed text-sm",children:(r==null?void 0:r.task)||`🎯 DEN ${t} - DŮVĚŘUJ PROCESU!

📌 VZPOMEŇ SI:
Kdy jsi naposledy dostala kompliment na svou pleť?

💪 ÚKOL:
Dnes se podívej do zrcadla a najdi 3 věci, které se ti na své pleti líbí.
⭐ Napiš si je do poznámky a usmej se na sebe!`})})]})}),!R&&e.jsx(p,{className:"border border-gray-200 shadow-sm",children:e.jsxs(j,{className:"p-6 space-y-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[e.jsx(fe,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{children:"Jak se dnes cítíš?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Celková nálada"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:re.map(s=>e.jsxs("button",{onClick:()=>W(s.value),className:`
                        p-3 rounded-lg border-2 transition-all duration-200 text-center
                        ${i.mood===s.value?"border-pink-500 bg-pink-50 shadow-md transform scale-105":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}
                      `,children:[e.jsx("div",{className:"text-2xl mb-1",children:s.emoji}),e.jsx("div",{className:"text-xs text-gray-600",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Hodnocení pleti (1-5 hvězdiček)"}),e.jsx("div",{className:"flex space-x-2 justify-center",children:[1,2,3,4,5].map(s=>e.jsx("button",{onClick:()=>Y(s),className:"p-2 rounded-lg transition-colors duration-200 hover:bg-gray-100",children:e.jsx(be,{className:`w-8 h-8 ${s<=i.skinRating?"text-yellow-400 fill-current":"text-gray-300"}`})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Poznámka (volitelné)"}),e.jsx("textarea",{value:i.note,onChange:s=>g(a=>({...a,note:s.target.value})),placeholder:"Jak se dnes cítíš? Nějaké změny na pleti?",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent resize-none",rows:3})]}),f&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-start space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(k,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-1",children:["Povinná fotodokumentace - Den ",t]}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"Dnes je čas na týdenní fotografii pokroku! Pořiď si selfie svého obličeje, abychom ti mohli ukázat, jak se tvá pleť zlepšuje. 📸"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("p",{children:["💡 ",e.jsx("strong",{children:"Tip:"})," Foť se vždy za stejného světla a ze stejného úhlu"]}),e.jsxs("p",{children:["🔒 ",e.jsx("strong",{children:"Soukromí:"})," Tvoje fotky jsou pouze tvoje - nikdo jiný je neuvidí"]}),e.jsxs("p",{children:["🛡️ ",e.jsx("strong",{children:"Bezpečnost:"})," Fotky jsou šifrovaně uložené a není možné je zveřejnit"]})]})]})]}),P&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:P,alt:"Preview pokroku",className:"max-w-full max-h-48 rounded-lg shadow-md border-2 border-white"}),e.jsx("button",{onClick:()=>{L(null),U(null),g(s=>({...s,photos:[]}))},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 shadow-lg",children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"✓ Připraveno k uložení"})]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(N,{onClick:()=>{var s;return(s=A.current)==null?void 0:s.click()},variant:"outline",className:"flex-1 border-blue-300 text-blue-700 hover:bg-blue-50",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),P?"Změnit foto":"Vybrat foto"]}),C&&!E&&e.jsxs(N,{onClick:se,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Nahrát foto"]}),E&&e.jsxs(N,{disabled:!0,className:"flex-1 bg-gray-400 text-white cursor-not-allowed",children:[e.jsx(Q,{className:"w-4 h-4 mr-2 animate-spin"}),"Nahrávám..."]})]}),e.jsx("input",{ref:A,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:ee,className:"hidden"})]})}),e.jsx(N,{onClick:te,className:"w-full py-3 text-lg font-semibold rounded-lg bg-gradient-to-r from-pink-500 to-rose-500 text-white hover:from-pink-600 hover:to-rose-600 transform hover:scale-105 transition-all duration-200",children:e.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[e.jsx(w,{className:"w-5 h-5"}),e.jsx("span",{children:f?"Dokončit den + foto":"Dokončit den"})]})}),f&&e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-orange-600 flex items-center justify-center space-x-1",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:"Foto je dnes povinné pro dokončení dne"})]})})]})})]})]})}function De(n,t){const h=Object.keys(n).map(Number).sort((l,m)=>m-l);if(h.length===0)return 0;let r=0,u=t-1;for(const l of h)if(l===u)r++,u--;else break;return r}export{Ze as default};
